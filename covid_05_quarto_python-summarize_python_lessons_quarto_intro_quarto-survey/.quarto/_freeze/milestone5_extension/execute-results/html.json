{
  "hash": "a139ccccc4cecd0f3ab641aa96caf2cc",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Final report\nauthor:\n  name: Tamires Martins\n  email: tamiresmartins.fln@gmail.com\n  url: 'https://github.com/tamimart'\nformat:\n  html:\n    code-fold: true\n    theme: cosmo\neditor: visual\n---\n\n::: {#setup .cell execution_count=1}\n``` {.python .cell-code}\n# Import packages \nimport pandas as pd\nfrom matplotlib import rcParams\nfrom plotnine import ggplot, aes, geom_line, scale_x_datetime, theme_classic, labs, theme, element_text, facet_wrap\nfrom mizani.breaks import date_breaks\nfrom mizani.formatters import date_format\n\n\n# Set some options\npd.set_option('mode.copy_on_write', True)\npd.set_option('display.max_columns', None)\nrcParams.update({'savefig.bbox': 'tight'})\n\n# Read data\ncovid = pd.read_csv(\"covid.csv\")\n\n```\n:::\n\n\n# About data\n\nIn this analysis, I'm going to use the data from [The COVID Tracking Project](https://covidtracking.com/), which describes the data as follows:\n\n> We collect, cross-check, and publish COVID-19 data from 56 US states and territories in three main areas: testing, hospitalization, and patient outcomes, racial and ethnic demographic information via The COVID Racial Data Tracker, and long-term-care facilities via the Long-Term-Care tracker. We compile these numbers to provide the most complete picture we can assemble of the US COVID-19 testing effort and the outbreak's effects on the people and communities it strikes.\n\n# Analysis\n\nFirst, let's take a look at it's structure:\n\n::: {#cell-table .cell execution_count=2}\n``` {.python .cell-code}\ncovid\n```\n\n::: {#table .cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>state</th>\n      <th>tests</th>\n      <th>cases</th>\n      <th>hospitalizations</th>\n      <th>deaths</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2020-01-13</td>\n      <td>WA</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2020-01-14</td>\n      <td>WA</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2020-01-15</td>\n      <td>WA</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2020-01-16</td>\n      <td>WA</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2020-01-17</td>\n      <td>WA</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>20775</th>\n      <td>2021-03-07</td>\n      <td>NaN</td>\n      <td>5726</td>\n      <td>146</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>20776</th>\n      <td>2021-03-07</td>\n      <td>NaN</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>20777</th>\n      <td>2021-03-07</td>\n      <td>NaN</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>20778</th>\n      <td>2021-03-07</td>\n      <td>NaN</td>\n      <td>305</td>\n      <td>305</td>\n      <td>0</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>20779</th>\n      <td>2021-03-07</td>\n      <td>NaN</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>20780 rows Ã— 6 columns</p>\n</div>\n```\n:::\n:::\n\n\nWhat's the median death by state?\n\n::: {#c47c93a2 .cell execution_count=3}\n``` {.python .cell-code}\ncovid.groupby('state').median(['deaths']).sort_values(['deaths'], ascending=False)\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>tests</th>\n      <th>cases</th>\n      <th>hospitalizations</th>\n      <th>deaths</th>\n    </tr>\n    <tr>\n      <th>state</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>CA</th>\n      <td>119323.0</td>\n      <td>4810.0</td>\n      <td>0.0</td>\n      <td>85.0</td>\n    </tr>\n    <tr>\n      <th>TX</th>\n      <td>43829.5</td>\n      <td>5310.5</td>\n      <td>0.0</td>\n      <td>80.5</td>\n    </tr>\n    <tr>\n      <th>FL</th>\n      <td>52840.0</td>\n      <td>3350.5</td>\n      <td>188.5</td>\n      <td>67.5</td>\n    </tr>\n    <tr>\n      <th>IL</th>\n      <td>46496.0</td>\n      <td>1980.0</td>\n      <td>0.0</td>\n      <td>42.0</td>\n    </tr>\n    <tr>\n      <th>NY</th>\n      <td>82009.0</td>\n      <td>2061.0</td>\n      <td>0.0</td>\n      <td>37.0</td>\n    </tr>\n    <tr>\n      <th>GA</th>\n      <td>19936.0</td>\n      <td>1952.0</td>\n      <td>128.0</td>\n      <td>35.0</td>\n    </tr>\n    <tr>\n      <th>PA</th>\n      <td>24258.0</td>\n      <td>1156.0</td>\n      <td>0.0</td>\n      <td>30.0</td>\n    </tr>\n    <tr>\n      <th>MA</th>\n      <td>22176.0</td>\n      <td>669.0</td>\n      <td>10.0</td>\n      <td>26.0</td>\n    </tr>\n    <tr>\n      <th>OH</th>\n      <td>26067.0</td>\n      <td>1201.5</td>\n      <td>98.0</td>\n      <td>26.0</td>\n    </tr>\n    <tr>\n      <th>NC</th>\n      <td>23879.0</td>\n      <td>1629.0</td>\n      <td>0.0</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>NJ</th>\n      <td>17687.0</td>\n      <td>1188.0</td>\n      <td>37.5</td>\n      <td>23.0</td>\n    </tr>\n    <tr>\n      <th>LA</th>\n      <td>12280.5</td>\n      <td>744.5</td>\n      <td>0.0</td>\n      <td>22.0</td>\n    </tr>\n    <tr>\n      <th>IN</th>\n      <td>18542.0</td>\n      <td>852.0</td>\n      <td>62.0</td>\n      <td>21.0</td>\n    </tr>\n    <tr>\n      <th>AZ</th>\n      <td>17732.0</td>\n      <td>1132.0</td>\n      <td>56.0</td>\n      <td>21.0</td>\n    </tr>\n    <tr>\n      <th>MI</th>\n      <td>23402.5</td>\n      <td>899.0</td>\n      <td>0.0</td>\n      <td>19.5</td>\n    </tr>\n    <tr>\n      <th>TN</th>\n      <td>16116.5</td>\n      <td>1490.0</td>\n      <td>47.5</td>\n      <td>17.0</td>\n    </tr>\n    <tr>\n      <th>SC</th>\n      <td>10401.0</td>\n      <td>1058.0</td>\n      <td>33.0</td>\n      <td>16.0</td>\n    </tr>\n    <tr>\n      <th>MD</th>\n      <td>21784.5</td>\n      <td>767.5</td>\n      <td>83.0</td>\n      <td>15.5</td>\n    </tr>\n    <tr>\n      <th>MS</th>\n      <td>1533.0</td>\n      <td>660.5</td>\n      <td>0.0</td>\n      <td>14.0</td>\n    </tr>\n    <tr>\n      <th>VA</th>\n      <td>13144.5</td>\n      <td>942.0</td>\n      <td>57.0</td>\n      <td>13.0</td>\n    </tr>\n    <tr>\n      <th>AL</th>\n      <td>6251.5</td>\n      <td>1034.5</td>\n      <td>32.0</td>\n      <td>12.0</td>\n    </tr>\n    <tr>\n      <th>MO</th>\n      <td>11711.5</td>\n      <td>1000.0</td>\n      <td>0.0</td>\n      <td>10.0</td>\n    </tr>\n    <tr>\n      <th>MN</th>\n      <td>15271.0</td>\n      <td>754.0</td>\n      <td>49.0</td>\n      <td>10.0</td>\n    </tr>\n    <tr>\n      <th>AR</th>\n      <td>7112.0</td>\n      <td>662.0</td>\n      <td>35.0</td>\n      <td>10.0</td>\n    </tr>\n    <tr>\n      <th>WI</th>\n      <td>17609.0</td>\n      <td>858.5</td>\n      <td>50.0</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>KY</th>\n      <td>7488.0</td>\n      <td>641.0</td>\n      <td>27.0</td>\n      <td>8.0</td>\n    </tr>\n    <tr>\n      <th>NV</th>\n      <td>7584.5</td>\n      <td>548.0</td>\n      <td>0.0</td>\n      <td>8.0</td>\n    </tr>\n    <tr>\n      <th>IA</th>\n      <td>3478.0</td>\n      <td>521.0</td>\n      <td>0.0</td>\n      <td>8.0</td>\n    </tr>\n    <tr>\n      <th>CO</th>\n      <td>11486.0</td>\n      <td>521.0</td>\n      <td>36.0</td>\n      <td>8.0</td>\n    </tr>\n    <tr>\n      <th>OK</th>\n      <td>6293.5</td>\n      <td>795.0</td>\n      <td>45.5</td>\n      <td>7.5</td>\n    </tr>\n    <tr>\n      <th>WA</th>\n      <td>8803.0</td>\n      <td>478.0</td>\n      <td>23.0</td>\n      <td>7.0</td>\n    </tr>\n    <tr>\n      <th>NM</th>\n      <td>6580.0</td>\n      <td>224.0</td>\n      <td>23.0</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>CT</th>\n      <td>13287.0</td>\n      <td>203.0</td>\n      <td>0.0</td>\n      <td>6.0</td>\n    </tr>\n    <tr>\n      <th>RI</th>\n      <td>5181.0</td>\n      <td>194.0</td>\n      <td>11.5</td>\n      <td>4.0</td>\n    </tr>\n    <tr>\n      <th>UT</th>\n      <td>6998.0</td>\n      <td>571.0</td>\n      <td>29.0</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>NE</th>\n      <td>4421.0</td>\n      <td>309.0</td>\n      <td>9.0</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>OR</th>\n      <td>7227.0</td>\n      <td>278.0</td>\n      <td>13.0</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>ID</th>\n      <td>1745.5</td>\n      <td>345.5</td>\n      <td>14.0</td>\n      <td>2.5</td>\n    </tr>\n    <tr>\n      <th>WV</th>\n      <td>4817.0</td>\n      <td>156.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>DE</th>\n      <td>3163.0</td>\n      <td>146.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>SD</th>\n      <td>1673.0</td>\n      <td>137.5</td>\n      <td>10.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>ME</th>\n      <td>3237.5</td>\n      <td>36.0</td>\n      <td>2.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>NH</th>\n      <td>3075.0</td>\n      <td>64.0</td>\n      <td>2.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>ND</th>\n      <td>3562.0</td>\n      <td>115.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>MT</th>\n      <td>2435.0</td>\n      <td>134.0</td>\n      <td>5.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>AK</th>\n      <td>2717.0</td>\n      <td>75.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>VT</th>\n      <td>1672.0</td>\n      <td>11.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>KS</th>\n      <td>18.0</td>\n      <td>3.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>HI</th>\n      <td>2853.0</td>\n      <td>63.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>WY</th>\n      <td>783.5</td>\n      <td>43.5</td>\n      <td>2.0</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n@fig-plot1 shows the pattern from the deaths-cases ratio on time for the top six states with more deaths.\n\n::: {#cell-fig-plot1 .cell execution_count=4}\n``` {.python .cell-code}\n# which six states had more deaths?\nsum_deaths_ordered = covid. \\\ngroupby('state'). \\\nsum('deaths'). \\\nsort_values('deaths', ascending=False)\n\n# get the six state list \ntop_six = sum_deaths_ordered.head(6).index.values.tolist()\n\n# filter\ncovid = covid.loc[covid.state.isin(top_six)]\n\n# remove NA and negative values \ncovid = covid.dropna()\nsubset = covid.loc[(covid['deaths'] >= 0) & (covid['cases'] >= 0)]\n\n# create new column = deaths/cases ratio\nsubset['cases_death_ratio'] = (subset['deaths'] / subset['cases'])\nsubset['state'] = pd.Categorical(subset['state'], categories=top_six, ordered=True)\n\n# plot\n(\nggplot(subset, aes(x='date')) +\n  geom_line(aes(y='cases_death_ratio', group='state', color='state')) +\n  facet_wrap('state') +\n  theme_classic() +\n  scale_x_datetime(breaks=date_breaks(\"3 months\"), labels=date_format(\"%m-%Y\")) +\n  labs(y='Deaths/Cases', x='Date') +\n  theme(\n   axis_text_x = element_text(rotation=45)\n)\n).show()\n```\n\n::: {.cell-output .cell-output-display}\n![Deaths-cases ratio on time.](milestone5_extension_files/figure-html/fig-plot1-output-1.png){#fig-plot1}\n:::\n:::\n\n\n",
    "supporting": [
      "milestone5_extension_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}